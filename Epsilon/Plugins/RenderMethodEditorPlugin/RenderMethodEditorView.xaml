<UserControl 
    x:Class="RenderMethodEditorPlugin.RenderMethodEditorView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:colorpicker="clr-namespace:ColorPicker;assembly=ColorPicker"
    xmlns:shader_parameters ="clr-namespace:RenderMethodEditorPlugin.ShaderParameters"
    mc:Ignorable="d" 
    d:DesignHeight="450" d:DesignWidth="800">

    <UserControl.InputBindings>
        <KeyBinding Command="{Binding SaveCommand}" Modifiers="Control" Key="S"/>
    </UserControl.InputBindings>
    
    <UserControl.Resources>
        
        <DataTemplate DataType="{x:Type shader_parameters:BooleanShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1,5">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,0,10,0"/>
                <CheckBox IsChecked="{Binding Value, Mode=TwoWay}" Width="100" HorizontalAlignment="Right"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:IntegerShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBox Text="{Binding Value}" Width="75" HorizontalAlignment="Right" Padding="1,1,1,1"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:SamplerShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBlock Text="Bitmap:" Padding="0,2,10,0"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox Text="{Binding Value, Mode=OneWay}" ToolTip="{Binding Value}" Width="400" HorizontalAlignment="Right" Padding="1" IsReadOnly="True"/>
                    <Button
                        Width="24"
                        Height="24"
                        Margin="4,0,0,0"
                        Padding="4,0,4,1"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Center"
                        Command="{Binding BrowseCommand}"
                        FontSize="14"
                        FontFamily="Segoe UI"
                        Content="⋯"
                        ToolTip="Select a tag from the Tag Browser." />
                    <Button
                        Width="24"
                        Height="24"
                        Margin="4,0,0,0"
                        Padding="3,3,4,4"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Center"
                        Command="{Binding NullCommand}"
                        FontFamily="Segoe UI"
                        FontSize="12"
                        Content="Ø"
                        ToolTip="Null this tag reference." />
                    <Button
                        Height="24"
                        Margin="4,0,0,0"
                        Padding="3,4,4,4"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Center"
                        Command="{Binding GotoCommand}"
                        FontSize="18"
                        FontFamily="Segoe UI"
                        ToolTip="Open this tag in a new tab.">
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <TextBlock Margin="0,-5,0,0" Text="➝" />
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>
                </StackPanel>
               
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:FloatShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBox Text="{Binding Value}" Width="75" HorizontalAlignment="Right" Padding="1,1,1,1"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:CategoryShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBlock Text="category:" Padding="0,2,10,0"/>
                <TextBox Text="{Binding Value}" Width="100" HorizontalAlignment="Right" Padding="1"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:ColorShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBlock Text="R:" Padding="0,3,7,0"/>
                <TextBox Text="{Binding Red}"  Width="70" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="G:" Padding="11,3,7,0"/>
                <TextBox Text="{Binding Green}"  Width="70" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="B:" Padding="11,3,7,0"/>
                <TextBox Text="{Binding Blue}"  Width="70" HorizontalAlignment="Right" Padding="1"/>
                <colorpicker:PortableColorPicker
                    Style="{StaticResource ColorPickerStyle}"
                    ColorState="{shader_parameters:ColorShaderParameterBinder}"
                    ShowAlpha="False"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:ArgbColorShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250" Padding="0,2,10,0"/>
                <TextBlock Text="A:" Padding="0,3,9,0"/>
                <TextBox Text="{Binding Alpha}"  Width="65" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="R:" Padding="10,3,9,0"/>
                <TextBox Text="{Binding Red}"  Width="65" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="G:" Padding="10,3,9,0"/>
                <TextBox Text="{Binding Green}"  Width="65" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="B:" Padding="10,3,9,0"/>
                <TextBox Text="{Binding Blue}"  Width="65" HorizontalAlignment="Right" Padding="1"/>
                <colorpicker:PortableColorPicker
                    Style="{StaticResource ColorPickerStyle}"
                    ColorState="{shader_parameters:ArgbColorShaderParameterBinder}"
                    ShowAlpha="True"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:TransformShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}">
                <TextBlock Text="" Width="250" Padding="0,2,10,0"/>
                <TextBlock Text="Scale X:" Padding="0,3,5,0"/>
                <TextBox Text="{Binding Value1}"  Width="40" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Scale Y:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value2}"  Width="40" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Offset X:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value3}"  Width="40" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Offset Y:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value4}"  Width="40" HorizontalAlignment="Right" Padding="1"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type shader_parameters:TransformRotationShaderParameter}">
            <StackPanel Orientation="Horizontal" ToolTip="{Binding Description}" Margin="1">
                <TextBlock Text="{Binding Name}" Width="250"/>
                <TextBlock Text="Rotation angle:" Padding="0,3,5,0"/>
                <TextBox Text="{Binding Value1}"  Width="100" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Scale XY:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value2}"  Width="100" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Offset X:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value3}"  Width="100" HorizontalAlignment="Right" Padding="1"/>
                <TextBlock Text="Offset Y:" Padding="10,3,5,0"/>
                <TextBox Text="{Binding Value4}"  Width="100" HorizontalAlignment="Right" Padding="1"/>
            </StackPanel>
        </DataTemplate>
        
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Text="Shader Options" Grid.Row="0" FontWeight="Bold" Padding="3,10,0,0"/>
        <Border
            Grid.Row="0"
            Padding="5,4,4,0"
            Margin="0"
            Background="Transparent"
            BorderBrush="Black"
            BorderThickness="0"
            Style="{StaticResource ToolBarStyle}">
            <Grid DockPanel.Dock="Top">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">

                    <ComboBox
                        MinWidth="50"
                        Margin="3,2"
                        VerticalAlignment="Center"
                        DisplayMemberPath="DisplayName"
                        IsEnabled="{Binding RteHasTargets, FallbackValue=False}"
                        ItemsSource="{Binding RteTargetList}"
                        SelectedItem="{Binding SelectedRteTargetItem, Mode=TwoWay}" />

                    <Button
                        Margin="4,2"
                        VerticalAlignment="Center"
                        Command="{Binding PokeCommand}"
                        Content="Poke"
                        ToolTip="Poke the current changes" />
                    <Separator Margin="4,0" />
                    <Button
                        Margin="4,2"
                        VerticalAlignment="Center"
                        Command="{Binding SaveCommand}"
                        Content="Save"
                        ToolTip="Save the current changes" />
                    <Button
                        Margin="4,2"
                        VerticalAlignment="Center"
                        Command="{Binding ReloadCommand}"
                        Content="Reload"
                        ToolTip="Reload tag definition from disk" />
                </StackPanel>
            </Grid>
        </Border>
        <ListView Margin="5" Name="shaderMethods" ItemsSource="{Binding ShaderMethods}" Grid.Row="1" Background="#FF2D2D30" Foreground="#f1f1f1">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Focusable" Value="false"/>
                    <Style.Triggers>
                        <Trigger Property="Control.IsMouseOver" Value="True">
                            <Setter Property="Control.Background" Value="#000000" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView>
                    <GridView.ColumnHeaderContainerStyle>
                        <Style TargetType="{x:Type GridViewColumnHeader}">
                            <!-- Set any properties you want to set -->
                            <Setter Property="Background" Value="LightGray" />
                            <Setter Property="Foreground" Value="Black" />
                        </Style>
                    </GridView.ColumnHeaderContainerStyle>

                    <GridViewColumn Header="Index" Width="auto" DisplayMemberBinding="{Binding MethodIndex}"/>
                    <GridViewColumn Header="Category Name" Width="200" DisplayMemberBinding="{Binding MethodName}" />
                    <GridViewColumn Header="Index" Width="auto" DisplayMemberBinding="{Binding OptionIndex}" />
                    <GridViewColumn Header="Selected Option" Width="200" DisplayMemberBinding="{Binding MethodOption}" />
                    <GridViewColumn Header="Option Description" DisplayMemberBinding="{Binding MethodDescription}" />
                </GridView>
            </ListView.View>
        </ListView>

        <TextBlock Text="Shader Parameters" Grid.Row="2" FontWeight="Bold" Padding="3,10,0,7"/>
        <ListBox ItemsSource="{Binding ShaderParameters}" Grid.Row="3">
            <ListBox.ItemContainerStyle>
                <Style TargetType="{x:Type ListBoxItem}">
                    <Setter Property="Focusable" Value="False"/>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>

        <!-- <Button Click="{s:Action Test}" Content="Sync" /> -->
    </Grid>
</UserControl>
